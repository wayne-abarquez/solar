!function(){"use strict";angular.module("solarApp",["ngMaterial","ngAnimate","restangular","oitozero.ngSweetAlert","ngFileUpload","treasure-overlay-spinner","angularInlineEdit","colorpicker.module","md.data.table"]).config(["RestangularProvider",function(e){var o=window.location.origin+"/api";e.setBaseUrl(o)}]).value("SOLAR_STATUSES",["In-Process","Submitted","Approved"]),console.log("solar app initialized!")}(),function(){"use strict";function e(e,o,n,a){function r(){console.log("upload solar file controller initialized!"),console.log("solar: "),console.log(n),console.log("file: "),console.log(a)}function t(){o.closeModal()}var l=this;l.initialize=r,l.closeModal=t,l.initialize()}angular.module("solarApp").controller("uploadSolarFileController",["$rootScope","modalServices","solar","file",e])}(),function(){"use strict";function e(e,o,n){function a(){l.solar=e,l.panel=o,l.paneldata=angular.copy(o),console.log("update solar panel controller intialized!")}function r(){e.one("panels",l.paneldata.id).customPUT(l.paneldata).then(function(e){n.hideModalWithReponse(e)},function(e){console.log("solar panel update error response: "),console.log(e)})}function t(){n.closeModal()}var l=this;l.initialize=a,l.updatePanel=r,l.closeModal=t,l.initialize()}angular.module("solarApp").controller("updateSolarPanelController",["solar","panel","modalServices",e])}(),function(){"use strict";function e(e,o,n,a,r,t,l,i,s,c,u,d,p,g,f,h){function m(){ee.states=l,ee.statuses=t,o.local=angular.copy(h),o.local.push(n),ee.local=h,ee.local.push(n),c.closeAllInfoBox(),n.$watch(angular.bind(ee,function(){return ee.solar}),function(){Z(),V()}),o.$watch("solarDetailSelectedTab",function(e,o){n.selectedTab=e}),ee.solar=r,n.$watch(angular.bind(ee,function(){if(ee.currentMarker)return ee.currentMarker.getPosition()}),X),o.$on("overlay-complete",function(){o.$apply(function(){o.showSaveAreaBtn=!0,o.showDeleteSelectedBtn=!0})}),te=o.$on("solar-screenshot-photo-uploaded",function(e,o){console.log("listen from solar-screenshot-photo-uploaded event!"),ee.solar.photos.push(o)}),ie=o.$on("solar-screenshot-photo-updated",function(e,o,n){console.log("listen from solar-screenshot-photo-updated event!"),ee.solar.photos[n]=o}),n.$on("$destroy",function(){_()})}function v(){ee.areaPolygon&&(ee.solar.area=u.getAreaFormData(ee.areaPolygon)),z().then(function(e){i.hideModalWithReponse(e.solar)},function(e){d.showInvalidDataMessages("Theres a problem processing your data.")})}function w(){i.closeModal()}function S(){s.getCurrentLocation().then(function(e){G(),ee.currentMarker=s.showCurrentLocation(e)})}function y(){G(),ee.currentMarker=s.showDraggableLocation(),c.addListener(ee.currentMarker,"dragend",function(e){n.$apply()})}function M(){H(),u.startDrawingMode(),oe.saveAreaListener=n.$on("save-area",Y),oe.cancelListener=n.$on("cancel-drawing",K),oe.deleteSelectedListener=n.$on("delete-selected",J)}function P(){u.stopDrawingMode(),Q();for(var e in oe)oe.hasOwnProperty(e)&&oe[e]&&(oe[e](),oe[e]=null);console.log("area listeners cleared")}function C(e,n,a){var r=o.local[0],t=o.local[1].showSolarDetailInfowindow;i.showUpdateSolarPanelDetails(e,ee.solar,n).then(function(e){console.log(e),r.panels[a]=e.panel},function(e){console.log(e)})["finally"](function(){t(r),o.solarDetailSelectedTab=1})}function k(e,a){f.initializeDrawPanel(),f.hidePanelById(e.id),ae.savePanelAreaListener=n.$on("save-area",function(){return u.overlayDataArray.length?(f.updatePanel(ee.solar,e).then(function(e){ee.solar.panels[a]=e.panel},function(e){console.log("error creating panel"),console.log(e)}),void I()):void d.showWarningDrawSolarPanelArea()}),ae.cancelPanelListener=n.$on("cancel-drawing",function(){f.showPanelById(e.id),u.stopDrawingMode(),Q();for(var o in ae)ae.hasOwnProperty(o)&&ae[o]&&(ae[o](),ae[o]=null)}),ae.deleteSelectedPanelListener=n.$on("delete-selected",function(){console.log("delete selected edit panel is called"),f.clearSelectedPanel(),o.showDeleteSelectedBtn=!1})}function L(){f.initializeDrawPanel(),ne.savePanelAreaListener=n.$on("save-area",D),ne.cancelPanelListener=n.$on("cancel-drawing",I),ne.deleteSelectedPanelListener=n.$on("delete-selected",b)}function O(e,o){f.deletePanel(ee.solar,e).then(function(e){ee.solar.panels.splice(o,1)},function(e){console.log("cannot delete panel!")})}function D(){return u.overlayDataArray.length?(f.savePanel(ee.solar).then(function(e){ee.solar.panels.push(e.panel)},function(e){console.log("error creating panel"),console.log(e)}),void I()):void d.showWarningDrawSolarPanelArea()}function b(){console.log("delete selected panel is called"),f.clearSelectedPanel(),o.showDeleteSelectedBtn=!1}function I(){u.stopDrawingMode(),Q();for(var e in ne)ne.hasOwnProperty(e)&&ne[e]&&(ne[e](),ne[e]=null)}function A(e){f.onPanelClick(e)}function T(){p.startDrawing(r,h),re||(re=o.$on("screenshot-taken",$))}function $(e,n){var a=g.parseScreenshotPhoto(n);a&&g.uploadSolarPhoto(a,ee.solar).then(function(e){var n=o.$emit("solar-screenshot-photo-uploaded",e.solar_file);n=null},function(e){console.log(e)}),re&&(re(),re=null)}function x(e,o){console.log("Edit Photo caption: "+e);o.caption;ee.solar.updatePhotoCaption(o,e).then(function(e){console.log("success"),console.log(e)},function(e){console.log("error!"),console.log(e)})}function E(e,n){p.startDrawing(ee.solar,h),le||(le=o.$on("screenshot-taken",function(a,r){console.log("change photo from screenshot listener called!");var t=g.parseScreenshotPhoto(r);t&&g.updateSolarPhoto(t,ee.solar,e).then(function(e){console.log("successfully updated photo!"),console.log(e);var a=o.$emit("solar-screenshot-photo-updated",e.solar_file,n);ee.solar.photos[n]=e.solar_file,a=null},function(e){console.log(e)}),le&&(le(),le=null)}))}function F(e,o){if(e)g.uploadSolarPhoto(e,ee.solar).then(function(e){ee.solar.photos.push(e.solar_file)},function(e){console.log("upload error"),console.log(e)});else{o&&o[0];d.showInvalidFileUpload()}}function B(e,o){e(o)}function W(e,o,n,a){if(console.log("update photo index: "+n),e)g.updateSolarPhoto(e,ee.solar,o).then(function(e){console.log("successfully updated photo!"),console.log(e),ee.solar.photos[n]=e.solar_file},function(e){console.log("upload error"),console.log(e)});else{a&&a[0];d.showInvalidFileUpload()}}function R(e,o){ee.solar.deletePhoto(e).then(function(e){ee.solar.photos.splice(o,1)},function(e){console.log(e),console.log("failed deleting photo")})}function U(e,n){i.previewImage(e,n,ee.local).then(function(e){console.log(e)},function(e){var n=o.local[0],a=o.local[1].showSolarDetailInfowindow;a(n),o.solarDetailSelectedTab=2})}function z(){var e=a.defer(),o=ee.solar.panels;return ee.solar.panels=[],ee.solar.customPUT(ee.solar).then(function(o){e.resolve(o)},function(o){console.log("error Response"),e.reject(o)})["finally"](function(){ee.solar.panels=o}),e.promise}function _(){console.log("on destroy triggered"),o.showScreenshotButtons||(te&&(te(),te=null),H(),j(),q(),N(),ee.stopDrawingMode(),ee.areaPolygon=null,ee.currentMarker=null,console.log("done clean up"))}function N(){re&&(re(),re=null),te&&(te(),te=null),le&&(le(),le=null),ie&&(ie(),ie=null)}function G(){ee.currentMarker&&c.destroyMarker(ee.currentMarker)}function j(){ee.currentMarker&&c.hideMarker(ee.currentMarker)}function Z(){if(void 0!=ee.solar&&null!=ee.solar){var e=ee.solar;e.area&&(ee.areaPolygon?c.updatePolygon(ee.areaPolygon,e.area):ee.areaPolygon=c.createPolygon(e.area),ee.areaPolygon.getMap()||c.showPolygon(ee.areaPolygon)),c.panTo(e.coordinates),c.setZoomInDefault()}}function V(){f.initializePanels(ee.solar.panels)}function H(){ee.areaPolygon&&c.hidePolygon(ee.areaPolygon)}function q(){f.hidePanels(),ee.solar.panels=[]}function Y(){return u.overlay?(ee.solar.area=u.overlayDataArray,ee.areaPolygon?(ee.areaPolygon.getMap()||ee.areaPolygon.setMap(c.map),c.updatePolygon(ee.areaPolygon,ee.solar.area)):ee.areaPolygon=c.createPolygon(ee.solar.area),void ee.stopDrawingMode()):void d.showWarningDrawSiteArea()}function K(){ee.areaPolygon&&!ee.areaPolygon.getMap()?c.showPolygon(ee.areaPolygon):ee.areaPolygon=null,ee.stopDrawingMode()}function J(){u.overlay&&(u.clearOverlay(),o.showDeleteSelectedBtn=!1,o.showSaveAreaBtn=!1)}function Q(){o.showMapCancelBtn=!1,o.showDeleteSelectedBtn=!1,o.showSaveAreaBtn=!1}function X(){ee.currentMarker&&(c.setZoomIfGreater(c.ZOOM_IN_LEVEL),c.centerMarker(ee.currentMarker),ee.solar.coordinates=ee.currentMarker.getPosition().toJSON(),c.reverseGeocode(ee.solar.coordinates).then(function(o){var n=o[0].formatted_address;e.info(n),ee.solar.address=n}))}var ee=this;n.selectedTab=0,ee.solar={id:0,panels:[]},ee.currentMarker=null,ee.areaPolygon=null,ee.local=null;var oe={saveAreaListener:null,cancelListener:null,deleteSelectedListener:null},ne={savePanelAreaListener:null,cancelPanelListener:null,deleteSelectedPanelListener:null},ae={savePanelAreaListener:null,cancelPanelListener:null,deleteSelectedPanelListener:null},re=null,te=null,le=null,ie=null;ee.initialize=m,ee.updateSolar=v,ee.closeModal=w,ee.initialize(),ee.getCurrentLocation=S,ee.pointCurrentLocation=y,ee.startDrawSite=M,ee.stopDrawingMode=P,ee.addSolarPanel=L,ee.deleteSolarPanel=O,ee.onPanelItemClick=A,ee.editSolarPanelShape=k,ee.editSolarPanelDetails=C,ee.uploadSolarPhotoModel=null,ee.uploadSolarPhotoErrorModel=null,ee.uploadSolarPhoto=F,ee.openPhotoMenu=B,ee.updateSolarPhoto=W,ee.deletePhoto=R,ee.editSolarPhotoCaption=x,ee.initializeScreenshot=T,ee.changePhotoFromScreenshot=E,ee.previewImage=U}angular.module("solarApp").controller("updateSolarController",["$log","$rootScope","$scope","$q","solar","SOLAR_STATUSES","usStates","modalServices","locationServices","gmapServices","drawingServices","alertServices","screenshotServices","uploadServices","solarPanelServices","local",e])}(),function(){"use strict";function e(e,o,n,a,r){function t(){s(),o.$watch(angular.bind(p,function(){return p.search}),c)}function l(e){return console.log("Row Clicked! "+e.project_name),e&&e.id&&r.openSolarInfoWindowById(e.id),!1}function i(o){e.$emit("show-solar-detail",{solar:o})}function s(){n.getList().then(function(o){console.log("Success fetching solars"),e.solarList=o,p.filterSolars()},function(e){console.log("Error when fetching solars")})}function c(){console.log("starting filter"),console.log(p.search),p.searchSolarFilters.$=p.search,u()}function u(){if(d())e.solars=e.solarList;else{var o=a("filter")(e.solarList,p.searchSolarFilters,!1);e.solars=o}}function d(){return null===p.search||""===p.search.trim()}var p=this;e.solarList=[],p.search="",p.searchSolarFilters={$:""},p.mdTableVars={order:"project_name",limit:10,page:1},p.tableHeaderList=[{name:"project_name",label:"Project"},{name:"client_name",label:"Client"},{name:"state",label:"State"},{name:"status",label:"Status"}],p.initialize=t,p.filterSolars=u,p.onClickRow=l,p.viewSolarDetail=i,p.initialize()}angular.module("solarApp").controller("solarListController",["$rootScope","$scope","Solars","$filter","solarGmapServices",e])}(),function(){"use strict";function e(e,o,n,a,r){function t(){e.$watch("imagePreview",l),c.imagePreview=r}function l(){if(c.imagePreview&&c.imagePreview.file){var e=new FileReader;e.onload=function(e){var n=e.target.result;o(function(){c.imagePreview.src=n})},e.readAsDataURL(c.imagePreview.file)}}function i(){console.log("saving"),n.resolveHideModal()}function s(){console.log("cancel"),n.closeModal()}var c=this;c.imagePreview={src:"",file:null},c.initialize=t,c.save=i,c.cancel=s,c.initialize()}angular.module("solarApp").controller("screenshotImageConfirmController",["$scope","$timeout","modalServices","$mdDialog","imagePreview",e])}(),function(){"use strict";function e(e,o,n,a){function r(){l.photo=a}function t(){console.log("cancel"),n.resolveHideModal()}var l=this;l.photo=null,l.initialize=r,l.close=t,l.initialize()}angular.module("solarApp").controller("previewImageController",["$scope","$timeout","modalServices","photo",e])}(),function(){"use strict";function e(e){function o(){}function n(o){return function(){e(o).toggle().then(function(){console.log("toggle "+o+" is done")})}}var a=this;a.menu=[{link:"#",title:"Admin",icon:"group"},{link:"/logout",title:"Logout",icon:"exit_to_app"}],a.initialize=o,a.toggleSideNav=n("sidenav"),a.initialize()}angular.module("solarApp").controller("mainController",["$mdSidenav",e])}(),function(){"use strict";angular.module("solarApp").controller("indexController",["$scope","$rootScope","$timeout","modalServices","gmapServices",function(e,o,n,a,r){function t(){console.log("initialize called"),l()}function l(){e.$watch(angular.bind(m,function(){return m.screenshotShapeStrokeColor}),function(e){o.screenshotShapeStrokeColor=e}),e.$watch(angular.bind(m,function(){return m.screenshotShapeFillColor}),function(e){o.screenshotShapeFillColor=e}),e.$watch(angular.bind(m,function(){return m.screenshotShapeStrokeWidth}),function(e){o.screenshotShapeStrokeWidth=e})}function i(e){a.showAddSolar(e).then(function(e){r.setZoomDefault();var a=e;n(function(){o.solarList.push(a)})},function(e){r.setZoomDefault()})}function s(){o.showSolarList=!o.showSolarList}function c(){o.$broadcast("save-area")}function u(){o.$broadcast("cancel-drawing")}function d(){o.$broadcast("delete-selected")}function p(){o.$broadcast("start-screenshot")}function g(){o.$broadcast("add-screenshot-text-bubble")}function f(){console.log("stroke width options clicked"),o.showStrokeWidth=!o.showStrokeWidth}function h(){console.log("broadcasting screenshot-cancelled"),o.$broadcast("screenshot-cancelled")}var m=this;o.solarDetailSelectedTab=0,o.selectedSolar=null,o.showMapCancelBtn=!1,o.showDeleteSelectedBtn=!1,o.showSolarList=!1,o.showSaveAreaBtn=!1,o.showScreenshotButtons=!1,o.showStrokeWidth=!1,o.screenshotShapeFillColor="",o.screenshotShapeStrokeColor="",o.spinner={active:!1},m.initialize=t,m.showAddSolarModal=i,m.toggleSolarList=s,m.saveArea=c,m.cancelDrawing=u,m.deleteSelected=d,m.showStrokeWidthOptions=f,m.endScreenshotMode=h,m.addTextBubble=g,m.startScreenshot=p,m.screenshotShapeFillColor="",m.screenshotShapeStrokeColor="",m.screenshotShapeStrokeWidth="",m.initialize()}])}(),function(){"use strict";function e(e,o,n,a){function r(){e.$watchCollection("solars",function(){console.log("solars changed!"),n.initializeSolarMarkers(e.solars)}),e.$on("modal-opened",i),e.$on("modal-dismissed",l),e.$on("show-solar-detail",function(e,o){s.showSolarDetailInfowindow(o.solar)}),$(document).on("click",".btn_view_solar_detail",function(){e.solarDetailSelectedTab=0,s.showSolarDetailInfowindow(e.selectedSolar)})}function t(o){if(o&&o.id){n.hideSolarMarkers();var r=a.showUpdateSolar(o,s,event);r.then(function(o){console.log("modalServices.showUpdateSolar response:"),console.log(o),o&&(n.gmapService.setZoomDefault(),n.showSolarMarkers(),e.selectedSolar&&o&&(e.selectedSolar.coordinates=o.coordinates))},function(e){n.gmapService.setZoomDefault(),n.showSolarMarkers(),console.log("show update solar detail failed"),console.log(e)})}}function l(){n.showSolarMarkers(),n.resetZoom()}function i(){console.log("called from event : modal-opened"),console.log("gmapcontroller hide markers"),n.hideSolarMarkers(),e.showSolarList=!1}var s=this;s.initialize=r,s.showSolarDetailInfowindow=t,s.initialize()}angular.module("solarApp").controller("gmapController",["$rootScope","$timeout","solarGmapServices","modalServices",e])}(),function(){"use strict";function e(e,o,n,a,r,t,l,i,s,c){function u(){n.$watch(angular.bind(O,function(){if(O.currentMarker)return O.currentMarker.getPosition()}),S),o.$on("overlay-complete",function(){o.$apply(function(){o.showSaveAreaBtn=!0,o.showDeleteSelectedBtn=!0})}),n.$on("$destroy",function(){C()})}function d(){O.areaPolygon&&(O.solar.area=i.getAreaFormData(O.areaPolygon)),s.post(O.solar).then(function(e){console.log("Save Solar Response : "+JSON.stringify(e)),r.hideModalWithReponse(e.solar)},function(e){console.log("error");var o=e.data.errors,n=JSON.stringify(o);c.showInvalidDataMessages(n)})}function p(){t.getCurrentLocation().then(function(e){w(),l.setZoomIfGreater(l.ZOOM_IN_LEVEL),O.currentMarker=t.showCurrentLocation(e)})}function g(){w(),O.currentMarker=t.showDraggableLocation(),l.addListener(O.currentMarker,"dragend",function(e){l.setZoomIfGreater(l.ZOOM_IN_LEVEL),n.$apply()})}function f(){L(),o.showMapCancelBtn=!0,i.startDrawingMode(),D=o.$on("save-area",y),b=o.$on("cancel-drawing",M),I=o.$on("delete-selected",P)}function h(){i.stopDrawingMode(),v(),b&&(b(),b=null),D&&(D(),D=null)}function m(){r.closeModal()}function v(){o.showMapCancelBtn=!1,o.showDeleteSelectedBtn=!1,o.showSaveAreaBtn=!1}function w(){O.currentMarker&&l.destroyMarker(O.currentMarker)}function S(){O.currentMarker&&(l.centerMarker(O.currentMarker),O.solar.coordinates=O.currentMarker.getPosition().toJSON(),l.reverseGeocode(O.solar.coordinates).then(function(o){var n=o[0].formatted_address;e.info(n),O.solar.address=n}))}function y(){return i.overlay?(O.solar.area=i.overlayDataArray,O.areaPolygon?(O.areaPolygon.getMap()||O.areaPolygon.setMap(l.map),l.updatePolygon(O.areaPolygon,O.solar.area)):O.areaPolygon=l.createPolygon(O.solar.area),void O.stopDrawingMode()):void c.showWarningDrawSiteArea()}function M(){O.areaPolygon&&!O.areaPolygon.getMap()?l.showPolygon(O.areaPolygon):O.areaPolygon=null,O.stopDrawingMode()}function P(){i.overlay&&(i.clearOverlay(),o.showDeleteSelectedBtn=!1,o.showSaveAreaBtn=!1)}function C(){L(),k(),O.stopDrawingMode(),O.areaPolygon=null,O.currentMarker=null}function k(){O.currentMarker&&l.hideMarker(O.currentMarker)}function L(){O.areaPolygon&&l.hidePolygon(O.areaPolygon)}var O=this;O.states=a,O.currentMarker=null,O.areaPolygon=null,O.solar={};var D=null,b=null,I=null;O.initialize=u,O.getCurrentLocation=p,O.pointCurrentLocation=g,O.startDrawSite=f,O.stopDrawingMode=h,O.closeModal=m,O.saveSolar=d,O.initialize()}angular.module("solarApp").controller("addSolarController",["$log","$rootScope","$scope","usStates","modalServices","locationServices","gmapServices","drawingServices","Solars","alertServices",e])}(),function(){"use strict";function e(e){function o(){return e.get("/api/solars")}function n(o){return console.log("getsolardetail solarID : "+o),e.get("/api/solars/"+o)}function a(o,n){return e.put("/api/solars/"+o,n)}var r={};return r.getSolars=o,r.getSolarDetail=n,r.updateSolar=a,r}angular.module("solarApp").factory("webServices",["webRequestServices",e])}(),function(){"use strict";function e(e,o){function n(e){return null!=e&&e.isObject?_.map(e,function(e,o){return e+"="+value}).join("&"):""}var a={},r=location.protocol+"//user:pass@"+location.host+"/";return a.get=function(o,a){return e.get(r+o+"?"+n(a))},a.post=function(o,n){return e({url:r+o,method:"POST",data:JSON.stringify(n),headers:{"Content-Type":"application/json"}})},a.put=function(o,n){return e({url:r+o,method:"PUT",data:JSON.stringify(n),headers:{"Content-Type":"application/json"}})},a["delete"]=function(o){return e["delete"](o)},a.upload=function(e,n,a){return o.upload({url:r+e,method:"POST",fields:n,file:a})},a}angular.module("solarApp").factory("webRequestServices",["$http","Upload",e])}(),function(){"use strict";function e(){function e(e){return n[e>>4&15]+n[15&e]}var o={},n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return o.byteToHex=e,o}angular.module("solarApp").factory("utilServices",[e])}(),function(){"use strict";function e(e,o,n){function a(a,r){var t=a,l=e.defer();return t&&(o.showLoader(),r.upload(a).then(function(e){n.showFileUploadSuccess(),l.resolve(e.data)},function(e){n.showInvalidFileUpload(),l.reject(e)})["finally"](function(){o.hideLoader()})),l.promise}function r(a,r,t){var l=e.defer();return a&&(o.showLoader(),r.updateSolarPhoto(a,t.id).then(function(e){n.showFileUploadSuccess(),l.resolve(e.data)},function(e){n.showInvalidFileUpload(),l.reject(e)})["finally"](function(){o.hideLoader()})),l.promise}function t(e){var o=null,n=new Date,a=n.getTime(),r="screenshot-"+a+".png";try{o=new File([e],r,{type:e.type})}catch(t){o=e,o.name=r,o.type=e.type}return o}var l={};return l.uploadSolarPhoto=a,l.updateSolarPhoto=r,l.parseScreenshotPhoto=t,l}angular.module("solarApp").factory("uploadServices",["$q","loaderServices","alertServices",e])}(),function(){"use strict";function e(e,o){var n=e.all("solars");return e.extendModel("solars",function(e){return e.deletePanel=function(o){return e.one("panels",o).remove()},e.upload=function(n,a){var r=e.getRestangularUrl()+"/photos",t=a||"";return console.log("custom solar method : upload"),o.upload({url:r,method:"POST",data:{file:n,caption:t}})},e.updateSolarPhoto=function(n,a){var r=e.getRestangularUrl()+"/photos/"+a;return console.log("custom solar method : updateSolarPhoto"),o.upload({url:r,method:"POST",data:{file:n}})},e.deletePhoto=function(o){return console.log("custom solar method : deletePhoto"),e.one("photos",o.id).remove()},e.updatePhotoCaption=function(o,n){return console.log("custom solar method : updatePhotoCaption"),e.one("photos",o.id).customPUT({caption:n})},e}),n}angular.module("solarApp").factory("Solars",["Restangular","Upload",e])}(),function(){"use strict";function e(e,o,n,a){function r(){n.startDrawingMode(v.panelStrokeColor)}function t(e){e.length&&(v.panels=angular.copy(e),v.panels.forEach(function(e,o){v.panels[o].polygon=a.createPolygon(e.area,v.panelStrokeColor)}),console.log("panels initialied"))}function l(){v.panels.forEach(function(e){e.polygon&&(a.hidePolygon(e.polygon),e.polygon=null)}),v.panels=[]}function i(e){var o=g(e);return o.polygon?(a.hidePolygon(o.polygon),o):null}function s(e){var o=g(e);return o.polygon?(a.showPolygon(o.polygon),o):null}function c(e){return a.initPolygon(e,v.panelStrokeColor)}function u(e){var o=(new Date).getTime();return{name:"Panel-"+o,area:n.getAreaFormData(e)}}function d(o){var r=e.defer(),t=v.createPanelPolygon(n.overlayDataArray),l=v.createPanel(t);return o.all("panels").post(l).then(function(e){e.polygon=t,a.showPolygon(t);var o=e.panel;o.polygon=t,v.panels.push(o),r.resolve(e)},function(e){console.log("error creating panel"),console.log(e),a.hidePolygon(t),t=null,r.reject(e)}),r.promise}function p(o,r){var t=e.defer(),r=g(r.id),l=v.createPanelPolygon(n.overlayDataArray),i={area:n.getAreaFormData(l)};return o.one("panels",r.id).customPUT(i).then(function(e){console.log("solar panel update response: "),console.log(e),a.showPolygon(l);var o=e.panel;o.polygon=l,v.panels[r.index]=o,t.resolve(e)},function(e){console.log("solar panel update error response: "),console.log(e)}),t.promise}function g(e){var o=null;return v.panels.forEach(function(n,a){if(n.id==e)return o=n,void(o.index=a)}),o}function f(e){var e=g(e.id);e&&(v.lastSelectedPanel&&a.resetPolygonFill(v.lastSelectedPanel),e.polygon&&(v.lastSelectedPanel=e.polygon,a.fillPolygon(v.lastSelectedPanel),a.panToPolygon(e.polygon)),o(function(){a.resetPolygonFill(v.lastSelectedPanel)},3e3))}function h(o,n){var r=e.defer(),t=n.id;return o.deletePanel(t).then(function(e){var o=g(t);a.hidePolygon(o.polygon),v.panels.splice(o.index,1),r.resolve(e)},function(e){r.reject(e)}),r.promise}function m(){n.clearOverlay()}var v={};return v.panels=[],v.panelStrokeColor="#ff0000",v.lastSelectedPanel=null,v.initializeDrawPanel=r,v.initializePanels=t,v.hidePanels=l,v.hidePanelById=i,v.showPanelById=s,v.createPanelPolygon=c,v.createPanel=u,v.savePanel=d,v.updatePanel=p,v.findPanelById=g,v.deletePanel=h,v.onPanelClick=f,v.clearSelectedPanel=m,v}angular.module("solarApp").factory("solarPanelServices",["$q","$timeout","drawingServices","gmapServices",e])}(),function(){"use strict";function e(e,o){function n(){o.createMap("map-canvas")}function a(e){if(p.solarMarkers.length){var o=null;return p.solarMarkers.forEach(function(n,a){return n.solar?n.solar.id==e?(o=n,!1):void 0:null}),o}}function r(e){var o=p.findMarkerById(e);null!==o&&google.maps.event.trigger(o,"click")}function t(e){if(null==e||"undefined"==e)return void s();o.closeAllInfoBox();for(var n=0;n<p.solarMarkers.length||n<e.length;n++){var a=e[n];if(n>=p.solarMarkers.length){var r=o.createCustomMarker(a.coordinates);r.infowindow=u(a),r.solar=a,p.solarMarkers.push(r),o.addListener(r,"click",l)}else n>=e.length?(p.solarMarkers[n]&&(p.solarMarkers[n].solar=null),o.hideMarker(p.solarMarkers[n])):p.solarMarkers[n]&&(p.solarMarkers[n].solar=a,p.solarMarkers[n].setPosition(a.coordinates),o.showMarker(p.solarMarkers[n]))}}function l(){o.openInfoBox(this.infowindow,this),o.panTo(this.getPosition()),e.selectedSolar=this.solar}function i(){!p.solarMarkers||p.solarMarkers.length<=0||o.showMarkers(p.solarMarkers)}function s(){!p.solarMarkers||p.solarMarkers.length<=0||(o.hideMarkers(p.solarMarkers),o.closeAllInfoBox())}function c(){o.setZoomDefault()}function u(e){var n=d(e);return o.createInfoBox(n)}function d(e){return'<div class="marker_info none" id="marker_info"><div class="info" id="info"><h4>'+e.project_name+"<span></span></h4><span>"+e.state+'</span><a href="#!" class="infowindow_btn btn_view_solar_detail">More info</a><span class="arrow"></span></div></div>'}var p={};return p.solarMarkers=[],p.gmapService=o,p.initialize=n,p.initializeSolarMarkers=t,p.showSolarMarkers=i,p.hideSolarMarkers=s,p.findMarkerById=a,p.openSolarInfoWindowById=r,p.resetZoom=c,p.initialize(),p}angular.module("solarApp").factory("solarGmapServices",["$rootScope","gmapServices",e])}(),function(){"use strict";function e(e,o,n,a,r,t,l,i){function s(e,o){R.solar=e,R.local=o,C(),M(),r.resolveHideModal(),P(),c(),$(document).keyup(W)}function c(){e.$watch("screenshotShapeStrokeColor",S),e.$watch("screenshotShapeFillColor",w),e.$watch("screenshotShapeStrokeWidth",y),Z.deleteSelectedListener=e.$on("delete-selected",I),Z.addTextBubbleListener=e.$on("add-screenshot-text-bubble",m),Z.startScreenshotListener=e.$on("start-screenshot",u)}function u(){R.screenshotDrawingManager||(R.screenshotDrawingManager=a.createDrawingManager(),a.showDrawingManager(R.screenshotDrawingManager)),R.screenshotDrawingListener||(R.screenshotDrawingListener=a.addListener(R.screenshotDrawingManager,"overlaycomplete",g));var e={drawingMode:null};R.screenshotDrawingManager.setOptions(e);var o={drawingMode:google.maps.drawing.OverlayType.RECTANGLE,drawingControl:!1,rectangleOptions:{fillOpacity:0,strokeOpacity:.9,strokeColor:"#ffffff",zIndex:3}};R.screenshotDrawingManager.setOptions(o),x()}function d(){for(var e in Z)Z.hasOwnProperty(e)&&Z[e]&&(Z[e](),Z[e]=null)}function p(){R.screenshotDrawingManager&&(a.hideDrawingManager(R.screenshotDrawingManager),R.screenshotDrawingManager=null),R.screenshotDrawingListener&&(a.removeListener(R.screenshotDrawingListener),R.screenshotDrawingListener=null)}function g(n){i.showLoader(),p();var t=n.overlay;a.hidePolygon(t);var l=t.getBounds(),s=a.fromLatLngToContainerPixel(l.getNorthEast()),c=a.fromLatLngToContainerPixel(l.getSouthWest()),u={x:c.x,y:s.y,width:s.x-c.x,height:c.y-s.y};f(),o(function(){html2canvas(document.getElementById("map-canvas"),{logging:!0,imageTimeout:12e4,proxy:"/html2canvasproxy"}).then(function(o){i.hideLoader(!0),h(),C();var n=document.createElement("canvas");n.width=u.width,n.height=u.height;var a=n.getContext("2d");a.drawImage(o,u.x,u.y,u.width,u.height,0,0,u.width,u.height);var t=function(o){var n=o,a={file:n,caption:"Screenshot"};r.showScreenshotImageConfirmation(a).then(function(o){R.endDrawing();var a=e.$broadcast("screenshot-taken",n);a=null},function(){})};n.toBlob(t)})})}function f(){j=$(".gm-style>div:first>div").css("transform");var e=j.split(","),o=parseFloat(e[4]),n=parseFloat(e[5]);$(".gm-style>div:first>div").css({transform:"none",left:o,top:n})}function h(){$(".gm-style>div:first>div").css({transform:j,left:0,top:0})}function m(){if(H||(H=a.addMapListener("click",function(e){l.addInfoWindow(e.latLng),v()}),a.setMapCursorCrosshair()),R.screenshotDrawingManager){var e={drawingMode:null};R.screenshotDrawingManager.setOptions(e)}}function v(){H&&(a.setMapCursorDefault(),a.removeListener(H),H=null)}function w(){var o=e.screenshotShapeFillColor;if(o){var n=/rgba\(([0-9\.]+),([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/.exec(o),a="#"+t.byteToHex(parseFloat(n[1]))+t.byteToHex(parseFloat(n[2]))+t.byteToHex(parseFloat(n[3]));U=E("circleOptions",["fillColor","fillOpacity"],[a,parseFloat(n[4])]),z=E("polygonOptions",["fillColor","fillOpacity"],[a,parseFloat(n[4])]),N=E("polylineOptions",["fillColor","fillOpacity"],[a,parseFloat(n[4])]),G=E("rectangleOptions",["fillColor","fillOpacity"],[a,parseFloat(n[4])]),F()}}function S(){var o=e.screenshotShapeStrokeColor;if(o){var n=/rgba\(([0-9\.]+),([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/.exec(o),a="#"+t.byteToHex(parseFloat(n[1]))+t.byteToHex(parseFloat(n[2]))+t.byteToHex(parseFloat(n[3]));U=E("circleOptions",["strokeColor","strokeOpacity"],[a,parseFloat(n[4])]),z=E("polygonOptions",["strokeColor","strokeOpacity"],[a,parseFloat(n[4])]),N=E("polylineOptions",["strokeColor","strokeOpacity"],[a,parseFloat(n[4])]),G=E("rectangleOptions",["strokeColor","strokeOpacity"],[a,parseFloat(n[4])]),F()}}function y(){var n=e.screenshotShapeStrokeWidth;o(function(){R.lineWidth=n}),U=E("circleOptions",["strokeWeight"],[n]),z=E("polygonOptions",["strokeWeight"],[n]),N=E("polylineOptions",["strokeWeight"],[n]),G=E("rectangleOptions",["strokeWeight"],[n]),F()}function M(){V||(V=e.$on("screenshot-cancelled",R.endDrawing))}function P(){e.showScreenshotButtons=!0}function C(){return R.drawingManager?(k(),void console.log("Reinitialize Drawing Listener on Screenshot Services")):(R.drawingManager=a.createDrawingToolsManager(),a.showDrawingManager(R.drawingManager),void k())}function k(){a.apiAvailable()&&(R.drawingCompleteListener||(R.drawingCompleteListener=a.addListener(R.drawingManager,"overlaycomplete",L)),o(function(){P()}))}function L(e){var o={shape:e.overlay,type:e.type,listener:a.addListener(e.overlay,"click",R.onClickShape)};R.shapes.push(o),R.selectLastShape()}function O(){var e=_.findIndex(R.shapes,{shape:this});e>=0&&R.selectShape(R.shapes[e])}function D(n){R.selectedShape&&(R.selectedShape.shape.setDraggable(!1),R.selectedShape.type!=google.maps.drawing.OverlayType.MARKER&&R.selectedShape.shape.setEditable(!1));var a=n;o(function(){R.selectedShape=a,R.selectedShape&&R.selectedShape.shape&&(R.selectedShape.shape.setDraggable(!0),R.selectedShape.type!=google.maps.drawing.OverlayType.MARKER&&R.selectedShape.shape.setEditable(!0),e.hasScreenshotSelectedShape=!0)})}function b(){R.shapes.length>0?R.selectShape(R.shapes[R.shapes.length-1]):R.selectShape(null)}function I(){R.selectedShape&&(A(_.indexOf(R.shapes,R.selectedShape)),R.shapes.length<=0&&(e.hasScreenshotSelectedShape=!1))}function A(e){if(e>=0){var o=R.shapes[e];R.shapes.splice(e,1),a.removeListener(o.listener),a.hidePolygon(o.shape),delete o.shape,delete o.listener,R.selectedShape=null,R.selectLastShape()}}function T(){for(;R.shapes.length>0;)R.deleteShapeAtIndex(R.shapes.length-1);l.clearInfoWindows(),x(),B();var o=R.local[0],n=R.local[1].showSolarDetailInfowindow;n(o),console.log("endDrawing is called"),console.log("scope local trigger destroy: "),console.log(R.local[2]),R.local[2].$destroy(),R.local[2]=null,e.solarDetailSelectedTab=2}function x(){R.drawingManager&&(a.hideDrawingManager(R.drawingManager),R.drawingManager=null),R.drawingCompleteListener&&(a.removeListener(R.drawingCompleteListener),R.drawingCompleteListener=null),v(),e.showScreenshotButtons=!1,e.showStrokeWidth=!1}function E(e,o,n){if(R.drawingManager){var a=R.drawingManager.get(e);if(a){for(var r=0;r<o.length&&r<n.length;r++){var t=o[r],l=n[r];a.hasOwnProperty(t)&&(a[t]=l)}return R.drawingManager.set(e,a),a}}return null}function F(){R.selectedShape&&(R.selectedShape.type==google.maps.drawing.OverlayType.MARKER||(R.selectedShape.type==google.maps.drawing.OverlayType.POLYLINE?R.selectedShape.shape.setOptions(N):R.selectedShape.type==google.maps.drawing.OverlayType.CIRCLE?R.selectedShape.shape.setOptions(U):R.selectedShape.type==google.maps.drawing.OverlayType.POLYGON?R.selectedShape.shape.setOptions(z):R.selectedShape.type==google.maps.drawing.OverlayType.RECTANGLE&&R.selectedShape.shape.setOptions(G)))}function B(){R.drawingManager&&(a.hideDrawingManager(R.drawingManager),R.drawingManager=null),
R.drawingCompleteListener&&(a.removeListener(R.drawingCompleteListener),R.drawingCompleteListener=null),V&&(V(),V=null),d()}function W(e){27==e.keyCode&&(i.hideLoader(),T())}var R={};R.drawingManager=null,R.drawingCompleteListener=null,R.screenShotDrawingManager=null,R.screenshotDrawingListener=null,R.shapes=[],R.selectedShape=null,R.lineWidth=1;var U=null,z=null,N=null,G=null;e.hasScreenshotSelectedShape=!1;var j="",Z={deleteSelectedListener:null,addTextBubbleListener:null,startScreenshotListener:null};R.startDrawing=s,R.endDrawing=T,R.onClickShape=O,R.selectShape=D,R.selectLastShape=b,R.deleteShapeAtIndex=A,R.deleteSelected=I,R.solar=null;var V=null,H=null;return R}angular.module("solarApp").factory("screenshotServices",["$rootScope","$timeout","$q","gmapServices","modalServices","utilServices","infoWindowServices","loaderServices",e])}(),function(){"use strict";function e(e,o,n,a,r){function t(a){var r=o.defer();return m.solarAddModal?r.reject("Modal already opened"):(e.$broadcast("modal-opened"),m.solarAddModal=n.show({controller:"addSolarController",controllerAs:"addSolarCtl",templateUrl:"/solar/add",parent:angular.element(document.querySelector("#solar-container")),targetEvent:a,hasBackdrop:!1,fullscreen:m.customFullscreen,onComplete:function(e,o,n){$(".md-scroll-mask").css("z-index","0")}}),m.solarAddModal.then(function(e){m.solarAddModal=null,r.resolve(e)},function(o){e.$broadcast("modal-dismissed"),m.solarAddModal=null,r.reject(o)})),r.promise}function l(a,t,l){var i=o.defer();if(console.log(l),m.showUpdateModal)m.showUpdateModal=null,i.reject("Modal already opened");else{e.$broadcast("modal-opened");var s=function(o){m.showUpdateModal=n.show({controller:"updateSolarController",controllerAs:"updateSolarCtl",templateUrl:"/solar/edit",parent:angular.element(document.querySelector("#solar-container")),targetEvent:l,hasBackdrop:!1,locals:{local:[a,t]},fullscreen:m.customFullscreen,resolve:{solar:function(){return angular.copy(o)}},onComplete:function(e,o,n){$(".md-scroll-mask").css("z-index","0")}}),m.showUpdateModal.then(function(e){m.showUpdateModal=null,i.resolve(e)},function(o){e.$broadcast("modal-dismissed"),m.showUpdateModal=null,i.reject(o)})},c=function(e){console.log("on get solar succeed result: "),console.log(e),s(e)},u=function(e){0!=e.status&&502!=e.status||i.reject(e)};r.get(a.id).then(c,u)}return i.promise}function i(a,r){var t=o.defer();return m.showUploadSolarFileModal?t.reject("Modal already opened"):(e.$broadcast("modal-opened"),m.showUploadSolarFileModal=n.show({controller:"uploadSolarFileController",controllerAs:"uploadSolarFileCtl",templateUrl:"/solar/upload",parent:angular.element(document.body),fullscreen:m.customFullscreen,hasBackdrop:!1,resolve:{solar:function(){return angular.copy(r)},file:function(){return angular.copy(a)}},onComplete:function(e,o,n){$(".md-scroll-mask").css("z-index","0")}}),m.showUploadSolarFileModal.then(function(e){m.showUploadSolarFileModal=null,t.resolve(e)},function(o){e.$broadcast("modal-dismissed"),m.showUploadSolarFileModal=null,t.reject(o)})),t.promise}function s(e){console.log("showScreenshotImageConfirmation called");var a=o.defer();return m.showScreenshotImageConfirmationModal?a.reject("Modal already opened"):(m.showScreenshotImageConfirmationModal=n.show({controller:"screenshotImageConfirmController",controllerAs:"screenshotImageConfirmCtl",templateUrl:"/image/screenshot/confirm",parent:angular.element(document.body),hasBackdrop:!1,fullscreen:m.customFullscreen,resolve:{imagePreview:function(){return e}},onComplete:function(e,o,n){$(".md-scroll-mask").css("z-index","0")}}),m.showScreenshotImageConfirmationModal.then(function(e){console.log("show screenshot modal save"),m.showScreenshotImageConfirmationModal=null,a.resolve(e)},function(e){console.log("show screenshot modal canceled"),m.showScreenshotImageConfirmationModal=null,a.reject(e)})),a.promise}function c(e,a,r){var t=o.defer();return m.previewImageModal?t.reject("Modal already opened"):(m.previewImageModal=n.show({controller:"previewImageController",controllerAs:"previewImageCtl",templateUrl:"/image/preview",parent:angular.element(document.body),hasBackdrop:!1,targetEvent:e,fullscreen:m.customFullscreen,clickOutsideToClose:!0,resolve:{photo:function(){return a}},onComplete:function(e,o,n){$(".md-scroll-mask").css("z-index","0")}}),m.previewImageModal.then(function(e){console.log("show screenshot modal save"),m.previewImageModal=null,t.resolve(e)},function(e){console.log("show screenshot modal canceled"),m.previewImageModal=null,t.reject(e)})),t.promise}function u(e,a,r){var t=o.defer();return m.showUpdateSolarPanelModal?t.reject("Modal already opened"):(m.showUpdateSolarPanelModal=n.show({controller:"updateSolarPanelController",controllerAs:"ctl",templateUrl:"/solar/panel/edit",parent:angular.element(document.body),hasBackdrop:!1,targetEvent:e,autoWrap:!1,fullscreen:m.customFullscreen,locals:{solar:a,panel:r},onComplete:function(e,o,n){$(".md-scroll-mask").css("z-index","0")}}),m.showUpdateSolarPanelModal.then(function(e){console.log("show update solar panel modal save"),m.showUpdateSolarPanelModal=null,t.resolve(e)},function(e){console.log("show update solar panel modal canceled"),m.showUpdateSolarPanelModal=null,t.reject(e)})),t.promise}function d(e){n.hide(e)}function p(){$(".md-dialog-container").css("display","none")}function g(){$(".md-dialog-container").css("display","flex")}function f(){n.hide()}function h(){n.cancel()}var m={};return m.customFullscreen=a("xs")||a("sm"),m.solarAddModal=null,m.showUpdateModal=null,m.showUploadSolarFileModal=null,m.showScreenshotImageConfirmationModal=null,m.previewImageModal=null,m.showAddSolar=t,m.showUpdateSolar=l,m.showUploadSolarFile=i,m.hideModalWithReponse=d,m.showScreenshotImageConfirmation=s,m.previewImage=c,m.showUpdateSolarPanelDetails=u,m.closeModal=h,m.hideModal=p,m.showModal=g,m.resolveHideModal=f,m}angular.module("solarApp").factory("modalServices",["$rootScope","$q","$mdDialog","$mdMedia","Solars",e])}(),function(){"use strict";function e(e,o){var n={};return n.getCurrentLocation=function(){if(!navigator.geolocation)return console.log("Browser doesnt support Geolocation"),!1;var o=e.defer();return navigator.geolocation.getCurrentPosition(function(e){o.resolve(e)}),o.promise},n.showCurrentLocation=function(e){var n={lat:e.coords.latitude,lng:e.coords.longitude},a=o.showCurrentLocation(n),r=.002;return o.panToOffsetLeft(n,r),o.setZoomInDefault(),a},n.showDraggableLocation=function(){var e=!0,n=o.map.getCenter(),a=o.showCurrentLocation(n,e);return a},n}angular.module("solarApp").factory("locationServices",["$q","gmapServices",e])}(),function(){"use strict";function e(e){function o(){e.spinner.active=!0}function n(o){var n=o||!1;n?e.$apply(function(){e.spinner.active=!1}):e.spinner.active=!1}var a={};return a.showLoader=o,a.hideLoader=n,a}angular.module("solarApp").factory("loaderServices",["$rootScope",e])}(),function(){"use strict";function e(e){function o(o){var n=e.createCanvasInfoWindow();n.uniqueId=r++,n.setPosition(o),n.open(),t.push(n)}function n(){for(;t.length>0;){var o=t[t.length-1];t.splice(t.length-1,1),e.hideCanvasInfoWindow(o),l.push(o)}}var a={},r=0,t=[],l=[];return a.addInfoWindow=o,a.clearInfoWindows=n,a}angular.module("solarApp").factory("infoWindowServices",["gmapServices",e])}(),function(){"use strict";function e(e,o){function n(){return"object"==typeof window.google}function a(e){var o=e||"map3d",n="#"+o;if(ve.map)return ve.map;if(!ve.apiAvailable())return null;var a={zoom:ve.defaultZoom,minZoom:2,center:ve.defaultLatLng,mapTypeId:google.maps.MapTypeId.HYBRID,mapTypeControlOptions:{position:google.maps.ControlPosition.LEFT_TOP,mapTypeIds:[google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.SATELLITE,we.USGSTopo]},zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},panControl:!1};$(n).height($(window).height()-42),ve.map=new google.maps.Map(document.getElementById(o),a),ve.geocoder=new google.maps.Geocoder,google.maps.event.addDomListener(window,"resize",function(){$(n).height($(window).height()-42);var e=ve.map.getCenter();google.maps.event.trigger(ve.map,"resize"),ve.map.setCenter(e)});var r=new google.maps.OverlayView;return r.draw=function(){},r.setMap(ve.map),ve.overlayView=r,ve.createWMSTopoMapType(),ve.map}function r(e){return new InfoBox({content:e||"",disableAutoPan:!0,maxWidth:0,pixelOffset:new google.maps.Size(25,(-115)),closeBoxURL:"static/resources/images/close-icon.png",isHidden:!1,pane:"floatPane",enableEventPropagation:!0})}function t(e,o){ve.map&&e&&o&&(ve.lastInfoboxOpen&&ve.lastInfoboxOpen.close(),e.open(ve.map,o),ve.lastInfoboxOpen=e,ve.infoboxes.push(e))}function l(){ve.infoboxes.forEach(function(e,o){e&&e.close()})}function i(){ve.lastInfoboxOpen&&ve.lastInfoboxOpen.close()}function s(e,o){return ve.map?ve.addListener(ve.map,e,o):null}function c(){ve.map&&ve.map.setOptions({draggableCursor:null})}function u(){ve.map&&ve.map.setOptions({draggableCursor:"crosshair"})}function d(e){ve.map&&ve.map.fitBounds(e)}function p(e){if(!ve.apiAvailable())return null;for(var o=new google.maps.LatLngBounds,n=0;n<e.length;n++){var a=e[n];o.extend(a)}return o}function g(e){return ve.apiAvailable()?google.maps.geometry.spherical.computeLength(e):0}function f(e){return ve.overlayView?ve.overlayView.getProjection().fromLatLngToContainerPixel(e):new google.maps.Point}function h(e){return ve.overlayView?ve.overlayView.getProjection().fromLatLngToDivPixel(e):new google.maps.Point}function m(e){if(ve.map){var o=1<<ve.map.getZoom(),n=new MercatorProjection,a=n.fromLatLngToPoint(e);return new google.maps.Point(a.x*o,a.y*o)}return new google.maps.Point}function v(e,o){return new google.maps.LatLng(e,o)}function w(e){return ve.apiAvailable()?new google.maps.InfoWindow({content:e}):null}function S(){return ve.apiAvailable()?new CanvasInfoWindow(ve.map):null}function y(e){e&&e.hideInfowindow()}function M(e,o){e&&e.open(ve.map,o)}function P(e){e&&e.close()}function C(e){google.maps.event.clearInstanceListeners(e)}function k(e,o,n){if(!ve.apiAvailable())return null;var a=n||{},r=angular.extend({},{position:e,map:ve.map,icon:o},a);return new google.maps.Marker(r)}function L(e,o){o=o||ve.MARKER_ICONS.RED;var n=ve.initMarker(e,o);return ve.markers.push(n),n}function O(e,o,n){var a=n||{},r=o||"images/markers/default-solar-marker.png";return ve.initMarker(e,r,a)}function D(e,o){var n={path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:o||"#6ac1ff",fillOpacity:1,strokeColor:"black",strokeWeight:1},a=ve.initMarker(e,n);return ve.markers.push(a),a}function b(e){ve.map&&ve.map.panTo(e)}function I(e,o){var n=o||.013,a={};e instanceof google.maps.LatLng?(console.log("object latlng"),a.lat=e.lat(),a.lng=e.lng()+n):(a=e,a.lng+=n),this.panTo(a)}function A(e){e&&e instanceof google.maps.Marker&&e.setMap(ve.map)}function T(e){e.forEach(function(e){ve.showMarker(e)})}function x(e){e&&e instanceof google.maps.Marker&&e.setMap(null)}function E(e){e.forEach(function(e){ve.hideMarker(e)})}function F(e){ve.hideMarker(e),e=null}function B(e){ve.map&&ve.map.setCenter(e.position)}function W(e){ve.map&&ve.map.setCenter(e)}function R(){ve.setMapCenter(ve.defaultLatLng)}function U(e){ve.map&&ve.map.setZoom(e)}function z(e){e>ve.map.getZoom()&&ve.setZoom(e)}function _(){ve.setZoom(ve.defaultZoom)}function N(){ve.setZoom(ve.ZOOM_IN_LEVEL)}function G(e){if(!ve.apiAvailable())return null;var o=e||"#0000ff",n=new google.maps.drawing.DrawingManager({drawingMode:null,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.POLYGON,google.maps.drawing.OverlayType.RECTANGLE]},polygonOptions:{clickable:!0,draggable:!0,editable:!0,geodesic:!0,fillColor:"#ffffff",fillOpacity:0,strokeColor:o,strokeOpacity:.9,strokeWeight:2,zIndex:1},rectangleOptions:{clickable:!0,draggable:!0,editable:!0,fillColor:"#ffffff",fillOpacity:0,strokeColor:o,strokeOpacity:.9,strokeWeight:2,zIndex:1}});return ve.drawingManager=n,n}function j(){if(!ve.apiAvailable())return null;var e=new google.maps.drawing.DrawingManager({drawingMode:null,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.MARKER,google.maps.drawing.OverlayType.CIRCLE,google.maps.drawing.OverlayType.POLYGON,google.maps.drawing.OverlayType.POLYLINE,google.maps.drawing.OverlayType.RECTANGLE]},markerOptions:{icon:ve.MARKER_ICONS.RED},circleOptions:{clickable:!0,draggable:!1,editable:!1,fillColor:"#0000ff",fillOpacity:.2,strokeColor:"#0000ff",strokeOpacity:.8,strokeWeight:1,zIndex:1},polygonOptions:{clickable:!0,draggable:!1,editable:!1,geodesic:!0,fillColor:"#0000ff",fillOpacity:.2,strokeColor:"#0000ff",strokeOpacity:.8,strokeWeight:1,zIndex:1},polylineOptions:{clickable:!0,draggable:!1,editable:!1,strokeColor:"#0000ff",strokeOpacity:.8,strokeWeight:1,zIndex:1},rectangleOptions:{clickable:!0,draggable:!1,editable:!1,fillColor:"#0000ff",fillOpacity:.2,strokeColor:"#0000ff",strokeOpacity:.8,strokeWeight:1,zIndex:1}});return ve.drawingManager=e,e}function Z(e){e&&(e.getMap()||e.setMap(ve.map),ve.setEnableDrawingManager(e,!0))}function V(e){e&&(e.setMap(null),ve.setEnableDrawingManager(e,!1))}function H(e,o){if(e){var n={drawingControl:o};o||(n.drawingMode=null),e.setOptions(n)}}function q(e,o,n){if(!ve.apiAvailable())return null;var a=new google.maps.LatLng(e,o),r={center:a,clickable:!1,draggable:!1,editable:!1,fillColor:"#ffffff",fillOpacity:0,map:ve.map,radius:n,strokeColor:"#0000ff",strokeOpacity:.9,strokeWeight:2,zIndex:100};return new google.maps.Circle(r)}function Y(e,o,n,a){e&&(e.setCenter({lat:o,lng:n}),e.setRadius(a))}function K(e,o){if(!ve.apiAvailable())return null;var n=o||"#0000ff",a={path:e,clickable:!1,draggable:!1,editable:!1,fillColor:n,fillOpacity:0,strokeColor:n,strokeOpacity:.9,strokeWeight:2,zIndex:100};return new google.maps.Polygon(a)}function J(e,o){var n=ve.initPolygon(e,o);return n.setMap(ve.map),n}function Q(e,o){e&&e.setPath(o)}function X(e){e&&e.setMap(ve.map)}function ee(e){e&&e.setMap(null)}function oe(e){e.setOptions({fillOpacity:0})}function ne(e){e.setOptions({fillOpacity:.5})}function ae(e){if(ve.map&&e){var o=new google.maps.LatLngBounds;e.getPath().forEach(function(e){o.extend(e)}),ve.panTo(o.getCenter())}}function re(e){if(!ve.apiAvailable())return null;var o={path:e,clickable:!1,draggable:!1,editable:!1,map:ve.map,strokeColor:"#ff0000",strokeOpacity:1,strokeWeight:5,zIndex:100};return new google.maps.Polyline(o)}function te(e,o){e&&e.setPath(o)}function le(e){e&&e.setMap(ve.map)}function ie(e){e&&e.setMap(null)}function se(e,o,n){return ve.apiAvailable()?google.maps.event.addListener(e,o,n):null}function ce(e,o,n,a){return ve.apiAvailable()?google.maps.event.addListenerOnce(e,o,n,a):null}function C(e){ve.apiAvailable()&&google.maps.event.clearInstanceListeners(e)}function ue(e,o){ve.apiAvailable()&&google.maps.event.clearListeners(e,o)}function de(e){ve.apiAvailable()&&google.maps.event.removeListener(e)}function pe(e,o,n){ve.apiAvailable()&&google.maps.event.trigger(e,o,n)}function ge(e,o){var n="/images/markers/current-location.png",a=o||!1;return ve.createCustomMarker(e,n,{draggable:a})}function fe(n){if(ve.geocoder){var a=o.defer();return ve.geocoder.geocode({latLng:n},function(o,n){if(n==google.maps.GeocoderStatus.OK)a.resolve(o);else{var r="Geocoder failed due to: "+n;e.error(r),a.reject(r)}}),a.promise}}function he(e,o){var n=ve.map.getProjection(),a=Math.pow(2,o),r=new google.maps.Point(256*e.x/a,256*(e.y+1)/a),t=new google.maps.Point(256*(e.x+1)/a,256*e.y/a),l=n.fromPointToLatLng(r),i=n.fromPointToLatLng(t),s="http://basemap.nationalmap.gov/arcgis/services/USGSTopo/MapServer/WMSServer?&REQUEST=GetMap&SERVICE=WMS&VERSION=1.3&LAYERS=",c="image%2Fjpeg",u="0",d="EPSG:4326",p=l.lat()+","+l.lng()+","+i.lat()+","+i.lng(),g=s+u+"&Styles=default&SRS="+d+"&BBOX="+p+"&width=256&height=256&format="+c+"&BGCOLOR=0xFFFFFF&TRANSPARENT=true&reaspect=false&CRS=EPSG:4326";return g}function me(){if(!ve.apiAvailable())return null;var e={alt:we.USGSTopo,getTileUrl:ve.WMSGetTopoUrl,isPng:!1,maxZoom:16,minZoom:1,name:we.USGSTopo,tileSize:new google.maps.Size(256,256),credit:"USGS"},o=new google.maps.ImageMapType(e);ve.map.mapTypes.set(we.USGSTopo,o)}var ve={},we={USGSTopo:"USGS Topo"};return ve.MARKER_ICONS={RED:"/resources/images/red-dot.png",YELLOW:"/resources/images/yellow-dot.png",GREEN:"/resources/images/green-dot.png",ERROR:"/resources/images/caution.png"},ve.INFO_WINDOWS=[],ve.ZOOM_OUT_LEVEL=6,ve.ZOOM_IN_LEVEL=17,ve.map=null,ve.overlayView=null,ve.geocoder=null,ve.markers=[],ve.defaultZoom=ve.ZOOM_OUT_LEVEL,ve.defaultLatLng=new google.maps.LatLng(32.7577,(-88.4376)),ve.lastInfoboxOpen=null,ve.infoboxes=[],ve.apiAvailable=n,ve.createMap=a,ve.createInfoBox=r,ve.openInfoBox=t,ve.closeInfoBox=i,ve.closeAllInfoBox=l,ve.setMapCursorCrosshair=u,ve.setMapBounds=d,ve.getBoundsFromPath=p,ve.setMapCursorDefault=c,ve.addMapListener=s,ve.getDistanceOfPath=g,ve.fromLatLngToContainerPixel=f,ve.fromLatLngToDivPixel=h,ve.fromLatLngToPoint=m,ve.createCoordinate=v,ve.createInfoWindow=w,ve.createCanvasInfoWindow=S,ve.hideCanvasInfoWindow=y,ve.showInfoWindow=M,ve.hideInfoWindow=P,ve.clearInstanceListeners=C,ve.initMarker=k,ve.createMarker=L,ve.createCustomMarker=O,ve.createCircleMarker=D,ve.panTo=b,ve.panToOffsetLeft=I,ve.showMarker=A,ve.showMarkers=T,ve.hideMarker=x,ve.hideMarkers=E,ve.destroyMarker=F,ve.centerMarker=B,ve.setMapCenter=W,ve.setMapCenterDefault=R,ve.setZoom=U,ve.setZoomIfGreater=z,ve.setZoomDefault=_,ve.setZoomInDefault=N,ve.createDrawingManager=G,ve.createDrawingToolsManager=j,ve.showDrawingManager=Z,ve.hideDrawingManager=V,ve.setEnableDrawingManager=H,ve.createCircle=q,ve.updateCircle=Y,ve.initPolygon=K,ve.createPolygon=J,ve.updatePolygon=Q,ve.showPolygon=X,ve.hidePolygon=ee,ve.resetPolygonFill=oe,ve.fillPolygon=ne,ve.panToPolygon=ae,ve.createPolyline=re,ve.updatePolyline=te,ve.showPolyline=le,ve.hidePolyline=ie,ve.addListener=se,ve.addListenerOnce=ce,ve.clearInstanceListeners=C,ve.clearListeners=ue,ve.removeListener=de,ve.trigger=pe,ve.showCurrentLocation=ge,ve.reverseGeocode=fe,ve.WMSGetTopoUrl=he,ve.createWMSTopoMapType=me,ve}angular.module("solarApp").factory("gmapServices",["$log","$q",e])}(),function(){"use strict";function e(){var e={};return e}angular.module("solarApp").factory("errorServices",[e])}(),function(){"use strict";function e(e,o,n){function a(){return S.drawingManager?(S.initDrawingListener(),void console.log("Reinitialize Drawing Listener")):(console.log("init drawing manager"),S.drawingManager=e.createDrawingManager(S.overlayStrokeColor),void S.initDrawingListener())}function r(){S.drawingManager&&(S.drawingCompleteListener||(S.drawingCompleteListener=e.addListener(S.drawingManager,"overlaycomplete",t),console.log("added drawing complete listener")))}function t(o){S.overlay&&(S.overlay.setMap(null),S.overlay=null,S.overlayDataArray=[]),S.overlay=o.overlay,S.overlay.setMap(e.map),S.overlayType=o.type,S.overlayDataArray=S.getAreaCoords(),S.setListenerOfType(o,function(e){S.overlay=e.overlay,S.overlayType=e.type,S.overlayDataArray=S.getAreaCoords(),console.log("shape changed")}),S.setPanControl(),n.$broadcast("overlay-complete")}function l(){S.drawingManager.setDrawingMode(null)}function i(){S.drawingManager&&e.hideDrawingManager(S.drawingManager)}function s(a){S.overlayStrokeColor=a||"",n.showMapCancelBtn=!0,S.initDrawingManager(),e.showDrawingManager(S.drawingManager),o.hideModal(),console.log("start drawing mode")}function c(e,o){switch(e.type){case google.maps.drawing.OverlayType.RECTANGLE:google.maps.event.addListener(e.overlay,"bounds_changed",function(){o(e)});break;case google.maps.drawing.OverlayType.POLYGON:google.maps.event.addListener(e.overlay.getPath(),"set_at",function(){o(e)}),google.maps.event.addListener(e.overlay.getPath(),"insert_at",function(n){o(e)})}}function u(){S.drawingCompleteListener&&(e.removeListener(S.drawingCompleteListener),S.drawingCompleteListener=null),S.hideDrawingManager(),o.showModal(),S.hideOverlay()}function d(){S.stopDrawingMode()}function p(){S.overlay&&(S.overlay.setMap(null),S.overlay=null)}function g(){p(),S.overlayDataArray=[],S.overlayType=""}function f(){return S.overlayType==google.maps.drawing.OverlayType.POLYGON?S.getPolygonCoords():S.overlayType==google.maps.drawing.OverlayType.RECTANGLE?S.getRectangleCorners():[]}function h(e){var o=e||S.overlay;if(o){var n=o.getPath().getArray(),a=[];for(var r in n)a.push({lat:n[r].lat(),lng:n[r].lng()});return a}}function m(e){return h(e)}function v(e){var o=e||S.overlay;if(o){var n=o.getBounds(),a=n.getNorthEast(),r=n.getSouthWest(),t=[];return t.push({lat:a.lat(),lng:a.lng()}),t.push({lat:r.lat(),lng:a.lng()}),t.push({lat:r.lat(),lng:r.lng()}),t.push({lat:a.lat(),lng:r.lng()}),t}}function w(){if(S.overlay){var e=S.overlay.getBounds(),o=e.getNorthEast(),n=e.getSouthWest(),a=[];return a.push({lat:o.lat(),lng:o.lng()}),a.push({lat:n.lat(),lng:n.lng()}),a}}var S={};return S.drawingManager=null,S.drawingCompleteListener=null,S.overlay=null,S.overlayType="",S.overlayDataArray=[],S.strokeColor="",S.initDrawingManager=a,S.initDrawingListener=r,S.setPanControl=l,S.hideDrawingManager=i,S.startDrawingMode=s,S.setListenerOfType=c,S.stopDrawingMode=u,S.cancelDrawingMode=d,S.hideOverlay=p,S.clearOverlay=g,S.getAreaCoords=f,S.getAreaFormData=m,S.getPolygonCoords=h,S.getRectangleCorners=v,S.getRectangleCoords=w,S}angular.module("solarApp").factory("drawingServices",["gmapServices","modalServices","$rootScope",e])}(),function(){"use strict";function e(e,o){function n(){e.swal({title:"Please draw site area.",type:"warning"})}function a(){e.swal({title:"Please Draw Solar Panel area.",type:"warning"})}function r(){e.swal({title:"Invalid File Uploaded.",type:"error"})}function t(){o.show(o.simple().textContent("File Successfully Uploaded.").position("top right").hideDelay(3e3))}function l(o){e.swal({title:"Invalid Data",text:o,type:"error",confirmButtonText:"Close"})}var i={};return i.showWarningDrawSiteArea=n,i.showInvalidDataMessages=l,i.showWarningDrawSolarPanelArea=a,i.showInvalidFileUpload=r,i.showFileUploadSuccess=t,i}angular.module("solarApp").factory("alertServices",["SweetAlert","$mdToast",e])}(),function(){"use strict";function e(e,o){function n(n,a,r){function t(){return p.prop("rows")[0].cells.length}function l(e,o){var n=o.prop("attributes");for(var a in n)e.attr(n[a].name,n[a].value);return e}function i(e){return Array.prototype.filter.call(e.cells,function(e){return!e.classList.contains("ng-leave")})}function s(){return a.parent().parent()}function c(e){return angular.element(e)}function u(){i(p.prop("rows")[0]).map(c).forEach(function(e,r){if(!e.hasClass("clone")){e.addClass("clone");var t=a.find("th").eq(r),l=o.getComputedStyle(t[0]);e.css("paddingBottom",g/2-t.children().prop("clientHeight")/2+"px");var i=function(){return l.width},s=function(){e.css("minWidth",l.width)},c=n.$watch(i,s);o.addEventListener("resize",s),e.on("$destroy",function(){c(),o.removeEventListener("resize",s)}),t.on("$destroy",function(){e.remove()})}})}var d=l(c("<table>"),a.parent()),p=a.clone().removeAttr("fixed").removeAttr("ng-if");d.css({position:"absolute",backgroundColor:"#fff",zIndex:1}).addClass("fixed"),a.css("visibility","hidden"),s().prepend(e(d.append(p))(n));var g=p.prop("clientHeight");s().css("position","relative").on("scroll",function(){0===s().prop("scrollTop")?d.removeClass("md-whiteframe-1dp"):d.hasClass("md-whiteframe-1dp")||d.addClass("md-whiteframe-1dp"),p.children().css("height",s().prop("scrollTop")+g+"px")}),n.$watch(t,u),a.on("$destroy",function(){d.remove()})}return console.log("fixed called"),{link:n}}angular.module("solarApp").directive("fixed",["$compile","$window",e])}(),function(){"use strict";var e=["Alabama","Alaska","American Samoa","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District Of Columbia","Federated States Of Micronesia","Florida","Georgia","Guam","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Marshall Islands","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Northern Mariana Islands","Ohio","Oklahoma","Oregon","Palau","Pennsylvania","Puerto Rico","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virgin Islands","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],o=["In-Process","Submitted","Approved"];angular.module("solarApp").value("usStates",e).value("solarStatuses",o)}();